# 2025 OOPL Final Report

## 組別資訊

組別：10
組員：112590007 鄭安琋、112590054 婁開翔
復刻遊戲：超級瑪利歐

## 專案簡介

### 遊戲簡介
復刻超級瑪利歐1985
一個超級義大利水管工闖關

操控遊戲角色瑪利歐經過層層關卡到達終點(綠色旗子處)，
玩家在遊戲地圖中持續奔跑、跳躍，躲避怪物的攻擊，此外可透過道具、遊戲機制擊敗怪物及獲取金幣，目標是到達終點

遊戲類型：2D、橫向卷軸
遊戲內容：原版遊戲中的 1-1、1-2、1-3 三個關卡

### 組別分工

| Week | 婁開翔                                               | 鄭安琋                                                                                                                                        |
|------|---------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
|  01  | 蒐集遊戲素材                                            | 設計角色基本類別                                                                                                                                   |
|  02  | 遊戲素材處理                                            | 設計角色基本類別 設計與測試碰撞箱                                                                                                                          |
|  03  | 設定瑪利歐的動畫處理與狀態變化時的圖片調換                             | 設計瑪利歐類別，包含初始化設定、角色移動、物理處理                                                                                                                  |
|  04  | 修正與調整瑪利歐的物理處理和加入長短跳                               | 測試瑪利歐的碰撞箱判斷與處理，讓遊戲畫面能夠隨著瑪利歐移動，設計方塊基本類別                                                                                                     |
|  05  | 設計與測試瑪利歐和方塊(碰撞箱)碰撞時的判斷、位置與速度修正                    | 設計問號箱、水管與磚塊類別，測試方塊能否在地圖中繪製出來                                                                                                               |
|  06  | 所有地圖繪製，將地圖的背景、方塊繪製整合                              | 將關卡的方塊數值(大小)儲存於Global 測試地圖Manager，設計碰撞Manager類別，集中處理物件的物理與碰撞，設計碰撞Manager類別，集中處理物件的物理與碰撞                                                    
|  07  | 測試地圖Manager，設計栗寶寶的類別                              | 在各MANAGER中加入關卡地板碰撞箱位置與寬高、水管位置與高度、旗子位置的紀錄                                                                                                   
|  08  | 設定地圖Manager與碰撞Manager的互相配合，處理物件的建構與刪除、互相取得資訊      | 測試遊戲的地圖繪製與物件碰撞判斷，修正Bug                                                                                                                     | 
|  09  | 加入BGM，測試BGM能否正常播放、關卡是否播放正確的BGM                    | 設計道具的基本類別，設計蘑菇、火焰花與金幣類別和無敵星星，將金幣與蘑菇加入到問號箱                                                                                                  |
|  10  | 烏龜的類別，將怪物加入到Manager，撰寫與測試瑪利歐和怪物的碰撞判斷和瑪利歐的分數計算     | 設計系統Manager，整合管理UI、遊戲畫面、金幣、剩餘時間與生命，加入與遊戲的開始、讀取、結束畫面                                                                                        |
|  11  | 完成第一關所有物件的繪製與碰撞判斷，將第二關的所有物件資訊(方塊、地板、怪物)紀錄於Manager | 修正地圖轉換的Bug                                                                                                                                 
|  12  | 撰寫食人花與移動平台類別，測試第二關的物件是否完整                         | 完成第二關所有物件的繪製與碰撞判斷，撰寫火球類別，撰寫問號箱生成道具的函式和瑪利歐射火球的函式，測試瑪利歐碰到道具的變化                                                                               |
|  13  | 將第三關的所有物件資訊(方塊、地板、怪物)紀錄於manager                   | 完成第三關所有物件的繪製與碰撞判斷，測試火球是否正常運作                                                                                                               |
|  14  | 檢查全體怪物碰撞、擊殺分數、互相交互邏輯、圖片轉換                         | 遊戲的通關動畫，測試通關動畫結束時能夠正確回到開始畫面、能夠再次遊玩遊戲，完成UI設定與分數系統                                                                                           
|  15  | 全部關卡背景圖片座標設定                                      | 加入遊戲通關時出現的通關訊息，撰寫與測試在通關遊戲時最高分數能否正常更新，測試在關卡轉換時時間能夠正常重置、時間到的話瑪利歐是否會死亡 ，測試瑪利歐得到道具和打倒敵人時分數/金幣會增加、通關時會將剩餘時間轉為分數，測試瑪利歐死亡時能夠正常減去生命或是進入結束畫面並回到開始畫面 |
|  16  | 為瑪利歐、怪物、方塊等物件加入音效，測試音效是否有遺漏、能正常播放                 | 將道具加入到地圖、碰撞Manager，撰寫關卡通關的判斷、關卡通關動畫(旗幟落下、瑪利歐進入城堡)、進入下一關的功能，特殊水管的功能，包含進出動畫、轉換地圖                                                             |
|  17  | 檢查與修正Manager類別中出現的各種bug、物件未正確處理的問題                | 確認遊戲是否能正常運作，檢查遊戲中是否有會嚴重影響遊玩的Bug，進而修正                                                                                                       |
## 遊戲介紹

### 遊戲規則
玩家在關卡中的目標為抵達關卡最後的城堡<br>
當玩家觸碰到城堡前的旗子時，關卡通關<br>
玩家需要打倒/躲避關卡中的陷阱如敵人、坑洞...等<br>
關卡中也會有能夠協助玩家通關的道具如蘑菇和火焰花以以及加命菇和無敵星星

### 遊戲畫面
<img src="gameimg (2).png" width="50%"/>
<img src="gameimg (1).png" width="50%"/>
<img src="gameimg (3).png" width="50%"/>
<img src="gameimg (4).png" width="50%"/>
## 程式設計

### 程式架構
- 主流程
  - main：掌管遊戲開始過程與結束的狀態
  - App：掌管遊戲開始過程與結束的過程
  - AppUtil：負責關卡物件初始化及換關
- Phase Resource Manager：掌管地圖上的水管、金幣、文字及其他背景圖片生成和更新狀態
- Enemy Manager：掌管怪物移動、碰撞、生成和更新狀態
  - 父類別：Enemy 怪物
    - Goomba 栗子怪：一般怪物，無特殊功能
    - Flower 食人花：生成在水管上，移動路徑為上下移動
    - Koopa 烏龜：具有行走和龜殼狀態，當瑪利歐踩到時會變成龜殼狀態，再次踩龜殼可讓龜殼滑行去碰撞其他生物(包含瑪利歐)，如果一段時間未踩龜殼，會重新變回行走狀態
    - FlyKoopa 飛天龜：在天空飛行的烏龜，當被踩到時會退化成一般烏龜，具有和一般烏龜相同特性，移動路徑為上下移動    
- Block Manager：掌管方塊生成和更新狀態
    - 父類別：Block 方塊
        - Common Block 一般方塊：可被瑪利歐破壞
        - Immovable Block 無法被破壞的方塊
        - Mystery Block 問號箱：具有道具在裡面，當瑪利歐撞擊時會掉出道具或金幣
- Prop Manager：掌管道具生成和更新狀態
    - 父類別：Prop 道具
        - Coin 金幣：吃下可獲得金幣及積分
        - Magic Mushroom 魔法蘑菇(紅色)：吃下可獲得長大狀態及積分
        - One Up Mushroom 加命菇(綠色)：吃下可加一條命
        - Fire Flower 火焰花：當為長大狀態時吃下可獲得火焰狀態，若瑪利歐為一般狀態則吃下效果和魔法蘑菇相同，可獲得積分  
        - Starman 無敵星星：吃下可獲得無敵狀態
- Fly Platform Manager
  - Fly Platform 移動平台：平台會上下或左右移動，分成會改變方向(到一定距離改變方向)和不會改變方向(到頂部或底部時生成在地圖另一側)的類型
- Fireball Manager：掌管火球的移動及狀態更新等
- 父類別：Background Image 背景圖片
  - Animated Image 動畫圖片：包含父類別及動畫相關函式
- 狀態
  - Collision State 碰撞狀態
  - Dead State 死亡狀態
- 其餘類別 
  - 父類別：Animated Character 動畫角色
    - Mario 瑪利歐：遊戲主角，玩家可透過鍵盤操控來移動
    - Fireball 火焰球：碰撞到怪物可讓怪物死亡，碰到牆壁時會爆炸，碰到地板時會持續跳躍
  - Renderer 鏡頭及渲染
  - TaskText 地圖的文字
  - Global 尺寸與座標偏差變數
### 程式技術
使用到的OOP技術：<br>
封裝、繼承 <br>
Function overload
## 結語

### 問題與解決方法
| 問題 | 解決方式 |
|------|----------|
| 寫完功能後有各種不同類型的bug | 使用中斷點或是print大法 找出bug |

### 自評

| 項次 | 項目                   | 完成 |
|------|------------------------|-------|
| 1    | 這是範例 |  V  |
| 2    | 完成專案權限改為 public |  V  |
| 3    | 具有 debug mode 的功能  |  V  |
| 4    | 解決專案上所有 Memory Leak 的問題  |  V  |
| 5    | 報告中沒有任何錯字，以及沒有任何一項遺漏  |  V  |
| 6    | 報告至少保持基本的美感，人類可讀  |  V  |
| 7    | 遊戲能正常開啟、遊玩 |  V  |


### 心得
在這次 OOPL 期末專案中，我們選擇了復刻經典的《Super Mario Bros. 1985》作為挑戰主題。這不只是我們童年回憶的一部分，更是一個絕佳的題材，可以讓我們實作各種物件導向設計技巧，如封裝、繼承、多型與類別模組化。

在整個開發過程中，我們深入學習了如何使用 C++ 實作一個完整的 2D 橫向卷軸遊戲。我們將角色、方塊、敵人、道具、地圖等元素以類別方式設計，並使用manager類別負責統整邏輯與資源控制，讓專案結構更清晰、也更容易除錯與維護。此外，我們運用了很多圖形函式庫來實作圖像繪製與音效播放，讓遊戲有了視覺與聽覺的完整呈現。
### 貢獻比例
112590007 鄭安琋 50%
112590054 婁開翔 50%